version: 1.0.{build}

environment:
  matrix:
  - COMPILER: gcc
    PLATFORM: mingw64

install:
  # running under CI
  - set CI_TESTING=1
  - 'echo End intall at: & time /t'
  - SET PATH_ORIGINAL=%PATH%
  - SET "PATH_MINGW64=c:\msys64\mingw64\bin;c:\msys64\usr\bin"
  - SET PATH=%PATH_MINGW64%;%PATH_ORIGINAL%
  - SET WORKDIR=C:\projects
  - git clone -q --branch=master https://github.com/tinysun212/test-repo-1.git sub-test-repo
  - cd sub-test-repo & git checkout -qf 318c395eb75002bfd32b5c0c3df94da53474782e
  - pacman -S --noconfirm mingw-w64-x86_64-cmake
  - pacman -S --noconfirm mingw-w64-x86_64-ninja
  - pacman -S --noconfirm mingw-w64-x86_64-clang       
  - pacman -S --noconfirm mingw-w64-x86_64-icu         
  - pacman -S --noconfirm mingw-w64-x86_64-libxml2     
  - pacman -S --noconfirm mingw-w64-x86_64-wineditline 
  - pacman -S --noconfirm mingw-w64-x86_64-winpthreads 
  - pacman -S --noconfirm mingw-w64-x86_64-pkg-config  
  - pacman -S --noconfirm mingw-w64-x86_64-dlfcn       
  - pacman -S --noconfirm make                         
  - pacman -S --noconfirm python                       
  - pacman -S --noconfirm python2                      

build_script:
  - cd
  - cd Src
  - gcc -o hello.exe hello.c

test_script:
  - 'echo test_script'
  - hello
